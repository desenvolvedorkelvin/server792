task_monsters = {
   [1] = {name = "rat", mons_list = {"rat", "cave rat"},  storage = 40000, amount = 50, exp = 250, pointsTask = {1, 1}, items = {{id = 2152, count = 3}, {id = 2789, count = 5}}},
   [2] = {name = "troll", mons_list = {"troll", "swamp troll", "island troll", "frost troll"}, storage = 40001, amount = 100, exp = 5000, pointsTask = {1, 1}, items = {{id = 2152, count = 10}, {id = 2789, count = 20}}},
   [3] = {name = "rotworm", mons_list = {"rotworm", "carrion worm"}, storage = 40002, amount = 300, exp = 4000, pointsTask = {1, 1}, items = {{id = 2152, count = 50}, {id = 2789, count = 20}}},
   [4] = {name = "cyclops", mons_list = {"cyclops"}, storage = 40003, amount = 500, exp = 25000, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2789, count = 20}}},
   [5] = {name = "tarantula", mons_list = {"tarantula"}, storage = 40004, amount = 400, exp = 16000, pointsTask = {1, 1}, items = {{id = 2160, count = 2}, {id = 2789, count = 20}}},
   [6] = {name = "larva", mons_list = {"larva"}, storage = 40005, amount = 300, exp = 4400, pointsTask = {1, 1}, items = {{id = 2152, count = 50}, {id = 2789, count = 20}}},
   [7] = {name = "scarab", mons_list = {"scarab"}, storage = 40006, amount = 500, exp = 20000, pointsTask = {1, 1}, items = {{id = 2152, count = 50}, {id = 2789, count = 20}}},
   [8] = {name = "ancient scarab", mons_list = {"ancient scarab"}, storage = 40007, amount = 250, exp = 60000, pointsTask = {1, 1}, items = {{id = 2160, count = 2}, {id = 2789, count = 20}}},
   [9] = {name = "wyvern", mons_list = {"wyvern"}, storage = 40008, amount = 300, exp = 51500, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2789, count = 20}}},
   [10] = {name = "dragon", mons_list = {"dragon"}, storage = 40009, amount = 400, exp = 93333, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2152, count = 50}}},
   [11] = {name = "dragon lord", mons_list = {"dragon lord"}, storage = 40010, amount = 600, exp = 420000, pointsTask = {1, 1}, items = {{id = 2160, count = 5}, {id = 2492, count = 1}}},
   [12] = {name = "frost dragon", mons_list = {"frost dragon"}, storage = 40011, amount = 600, exp = 420000, pointsTask = {1, 1}, items = {{id = 2160, count = 5}, {id = 2492, count = 1}}},
   [13] = {name = "ghoul", mons_list = {"ghoul"}, storage = 40012, amount = 400, exp = 11333, pointsTask = {1, 1}, items = {{id = 2160, count = 2}, {id = 2214, count = 1}}},
   [14] = {name = "amazon", mons_list = {"amazon", "valkyrie"}, storage = 40013, amount = 350, exp = 7000, pointsTask = {1, 1}, items = {{id = 2160, count = 1}, {id = 2152, count = 50}}},
   [15] = {name = "demon skeleton", mons_list = {"demon skeleton"}, storage = 40014, amount = 500, exp = 40000, pointsTask = {1, 1}, items = {{id = 2160, count = 2}, {id = 2152, count = 50}}},
   [16] = {name = "crystal Spider", mons_list = {"crystal spider"}, storage = 40015, amount = 500, exp = 150000, pointsTask = {1, 1}, items = {{id = 2160, count = 5}, {id = 2152, count = 80}}},
   [17] = {name = "goblin", mons_list = {"goblin"}, storage = 40016, amount = 200, exp = 1666, pointsTask = {1, 1}, items = {{id = 2152, count = 1}, {id = 2152, count = 20}}},
   [18] = {name = "tomb", mons_list = {"skeleton", "spider", "slime", "snake", "demon skeleton", "stalker", "Crypt Shambler", "fire elemental", "poison spider", "Cobra", "larva", "scorpion", "ghost", "scarab", "mummy", "Gargoyle"}, storage = 40017, amount = 1500, exp = 40000, pointsTask = {1, 1}, items = {{id = 2160, count = 5}, {id = 2159, count = 10}}},
   [19] = {name = "vampire", mons_list = {"vampire"}, storage = 40018, amount = 400, exp = 40666, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2152, count = 20}}},
   [20] = {name = "necromancer", mons_list = {"priestess", "necromancer"}, storage = 40019, amount = 600, exp = 116000, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2195, count = 1}}},
   [21] = {name = "minotaur", mons_list = {"minotaur", "minotaur mage", "minotaur archer", "minotaur guard"}, storage = 40020, amount = 500, exp = 8333, pointsTask = {1, 1}, items = {{id = 2160, count = 1}, {id = 2152, count = 50}}},
   [22] = {name = "pirate", mons_list = {"pirate carauder", "pirate cutthroat", "pirate ghost", "pirate buccaneer", "pirate corsair"}, storage = 40021, amount = 1000, exp = 81666, pointsTask = {1, 1}, items = {{id = 2160, count = 5}, {id = 5462, count = 1}}},
   [23] = {name = "giant spider", mons_list = {"giant spider"}, storage = 40022, amount = 500, exp = 150000, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2477, count = 1}}},
   [24] = {name = "serpent spawn", mons_list = {"serpent spawn"}, storage = 40023, amount = 800, exp = 813333, pointsTask = {1, 1}, items = {{id = 2160, count = 10}, {id = 2498, count = 1}}},
   [25] = {name = "elf", mons_list = {"elf", "elf arcanist", "Elf Scout"}, storage = 40024, amount = 700, exp = 67500, pointsTask = {1, 1}, items = {{id = 2160, count = 3}, {id = 2152, count = 20}}},
   [26] = {name = "orc", mons_list = {"orc", "orc leader", "orc shaman", "orc spearman", "orc warrior", "orc raider", "orc warlord"}, storage = 97500, amount = 1000, exp = 127500, pointsTask = {1, 1}, items = {{id = 2160, count = 4}, {id = 2152, count = 20}}},
   [27] = {name = "dwarf", mons_list = {"dwarf", "dwarf guard", "dwarf soldier", "dwarf geomancer"}, storage = 40026, amount = 400, exp = 97500, pointsTask = {1, 1}, items = {{id = 2160, count = 2}, {id = 2152, count = 50}}},
   [28] = {name = "warlock", mons_list = {"warlock"}, storage = 40027, amount = 900, exp = 1200000, pointsTask = {1, 1}, items = {{id = 2160, count = 10}, {id = 2123, count = 1}}},
   [29] = {name = "hydra", mons_list = {"hydra"}, storage = 40028, amount = 600, exp = 480000, pointsTask = {1, 1}, items = {{id = 2160, count = 6}, {id = 2195, count = 1}}},
   [30] = {name = "demon", mons_list = {"demon"}, storage = 40029, amount = 666, exp = 1500000, pointsTask = {1, 1}, items = {{id = 2160, count = 15}, {id = 2472, count = 1}}}

} 

task_daily = {
   [1] = {name = "monsterDay1", mons_list = {"monsterDay1_t2", "monsterDay1_t3"}, storage = 40000, amount = 10, exp = 5000, pointsTask = {1, 1}, items = {{id = 2157, count = 1}, {id = 2160, count = 3}}},
   [2] = {name = "monsterDay2", mons_list = {"", ""}, storage = 40001, amount = 10, exp = 10000, pointsTask = {1, 1}, items = {{id = 10521, count = 1}, {id = 2160, count = 5}}},
   [3] = {name = "monsterDay3", mons_list = {"", ""}, storage = 40002, amount = 10, exp = 18000, pointsTask = {1, 1}, items = {{id = 2195, count = 1}, {id = 2160, count = 8}}},
   [4] = {name = "monsterDay4", mons_list = {"", ""}, storage = 40003, amount = 10, exp = 20000, pointsTask = {1, 1}, items = {{id = 2520, count = 1}, {id = 2160, count = 10}}}
}

task_storage = 20020 -- storage que verifica se está fazendo alguma task e ver qual task é - task normal
task_points = 20021 -- storage que retorna a quantidade de pontos task que o player tem.
task_sto_time = 20022 -- storage de delay para não poder fazer a task novamente caso ela for abandonada.
task_time = 0 -- tempo em horas em que o player ficará sem fazer a task como punição
task_rank = 20023 -- storage do rank task
taskd_storage = 20024 -- storage que verifica se está fazendo alguma task e ver qual task é - task daily
time_daySto = 20025 -- storage do tempo da task daily, no caso para verificar e add 24 horas para fazer novamente a task daily


local ranks_task = {
[{1, 20}] = "Newbie", 
[{21, 50}] = "Elite",
[{51, 100}] = "Master",
[{101, 200}] = "Destroyer",		
[{201, math.huge}] = "Juggernaut"
}

local RankSequence = {
["Newbie"] = 1,
["Elite"] = 2,
["Master"] = 3,
["Destroyer"] = 4,
["Juggernaut"] = 5,
}

function rankIsEqualOrHigher(myRank, RankCheck)
	local ret_1 = RankSequence[myRank]
	local ret_2 = RankSequence[RankCheck]
	return ret_1 >= ret_2
end

function getTaskInfos(player)
	local player = Player(player)
	return task_monsters[player:getStorageValue(task_storage)] or false
end

function getTaskDailyInfo(player)
	local player = Player(player)
	return task_daily[player:getStorageValue(taskd_storage)] or false
end


function taskPoints_get(player)
	local player = Player(player)
	if player:getStorageValue(task_points) == -1 then
		return 0 
	end
	return player:getStorageValue(task_points)
end

function taskPoints_add(player, count)
	local player = Player(player)
	return player:setStorageValue(task_points, taskPoints_get(player) + count)
end

function taskPoints_remove(player, count)
	local player = Player(player)
	return player:setStorageValue(task_points, taskPoints_get(player) - count)
end

function taskRank_get(player)
	local player = Player(player)
	if player:getStorageValue(task_rank) == -1 then
		return 1 
	end
	return player:getStorageValue(task_rank)
end

function taskRank_add(player, count)
	local player = Player(player)
	return player:setStorageValue(task_rank, taskRank_get(player) + count)
end

function getRankTask(player)
	local pontos = taskRank_get(player)
	local ret
	for _, z in pairs(ranks_task) do
		if pontos >= _[1] and pontos <= _[2] then
			ret = z
		end
	end
	return ret
end

function getItemsFromTable(itemtable)
     local text = ""
     for v = 1, #itemtable do
         count, info = itemtable[v].count, ItemType(itemtable[v].id)
         local ret = ", "
         if v == 1 then
             ret = ""
         elseif v == #itemtable then
             ret = " - "
         end
         text = text .. ret
         text = text .. (count > 1 and count or info:getArticle()).." "..(count > 1 and info:getPluralName() or info:getName())
     end
     return text
end